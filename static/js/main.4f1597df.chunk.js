(this["webpackJsonpe-commerce"]=this["webpackJsonpe-commerce"]||[]).push([[0],{35:function(e,a,t){e.exports=t(65)},40:function(e,a,t){},65:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(32),c=t.n(s),l=(t(40),t(18)),i=t(9),m=t.n(i),o=t(15),u=t(10),d=t(11),h=t(13),p=t(12),v=t(8),E=t(1),b=t(14),f=t.n(b),g=t(33),N=t(7),C=r.a.createContext({}),y=function(e){return function(a){return r.a.createElement(C.Consumer,null,(function(t){return r.a.createElement(e,Object.assign({},a,{context:t}))}))}},x={email:"",password:"",id:""},k=y(function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var n;return Object(u.a)(this,t),(n=a.call(this,e)).save=function(){var e=Object(o.a)(m.a.mark((function e(a){var t,r,s,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),t=n.state,r=t.email,s=t.password,c=t.id,!r||!s){e.next=8;break}return e.next=5,f.a.post("http://localhost:3001/users",{email:r,password:s,id:c});case 5:n.setState({flash:{status:"is-success",msg:"Usuario created successfully"}}),e.next=9;break;case 8:n.setState({flash:{status:"is-danger",msg:"Please enter name and price"}});case 9:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),n.handleChange=function(e){var a;return n.setState((a={},Object(N.a)(a,e.target.name,e.target.value),Object(N.a)(a,"error",""),a))},n.state=x,n}return Object(d.a)(t,[{key:"render",value:function(){var e=this.state,a=e.email,t=e.password,n=e.id,s=this.props.context.user;return s&&s.accessLevel<1?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"hero is-primary "},r.a.createElement("div",{className:"hero-body container"},r.a.createElement("h4",{className:"title"},"Add Usuario"))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("form",{onSubmit:this.save},r.a.createElement("div",{className:"columns is-mobile is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Usuario: "),r.a.createElement("input",{className:"input",type:"text",name:"email",value:a,onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Password: "),r.a.createElement("input",{className:"input",type:"password",name:"password",value:t,onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"ID: "),r.a.createElement("input",{className:"input",type:"number",name:"id",value:n,onChange:this.handleChange,required:!0})),this.state.flash&&r.a.createElement("div",{className:"notification ".concat(this.state.flash.status)},this.state.flash.msg),r.a.createElement("div",{className:"field is-clearfix"},r.a.createElement("button",{className:"button is-primary is-danger is-outlined is-pulled-right",type:"submit",onClick:this.save},"Submit")))))):r.a.createElement(E.a,{to:"/"})}}]),t}(n.Component)),S={name:"",price:"",Img:"",stock:"",shortDesc:"",description:""},O=y(function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var n;return Object(u.a)(this,t),(n=a.call(this,e)).save=function(){var e=Object(o.a)(m.a.mark((function e(a){var t,r,s,c,l,i,o,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),t=n.state,r=t.name,s=t.price,c=t.Img,l=t.stock,i=t.shortDesc,o=t.description,!r||!s){e.next=10;break}return u=Math.random().toString(36).substring(2)+Date.now().toString(36),e.next=6,f.a.post("http://localhost:3001/products",{id:u,name:r,price:s,Img:c,stock:l,shortDesc:i,description:o});case 6:n.props.context.addProduct({name:r,price:s,Img:c,shortDesc:i,description:o,stock:l||0},(function(){return n.setState(S)})),n.setState({flash:{status:"is-success",msg:"Product created successfully"}}),e.next=11;break;case 10:n.setState({flash:{status:"is-danger",msg:"Please enter name and price"}});case 11:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),n.handleChange=function(e){var a;return n.setState((a={},Object(N.a)(a,e.target.name,e.target.value),Object(N.a)(a,"error",""),a))},n.state=S,n}return Object(d.a)(t,[{key:"render",value:function(){var e=this.state,a=e.name,t=e.price,n=e.stock,s=e.Img,c=e.shortDesc,l=e.description,i=this.props.context.user;return i&&i.accessLevel<1?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"hero is-primary "},r.a.createElement("div",{className:"hero-body container"},r.a.createElement("h4",{className:"title"},"Add Product"))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("form",{onSubmit:this.save},r.a.createElement("div",{className:"columns is-mobile is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Product Name: "),r.a.createElement("input",{className:"input",type:"text",name:"name",value:a,onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Price: "),r.a.createElement("input",{className:"input",type:"number",name:"price",value:t,onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"img"},r.a.createElement("label",{className:"label"},"Img: "),r.a.createElement("input",{className:"input",type:"text",name:"Img",value:s,onChange:this.handleChange,required:!0})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Available in Stock: "),r.a.createElement("input",{className:"input",type:"number",name:"stock",value:n,onChange:this.handleChange})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Short Description: "),r.a.createElement("input",{className:"input",type:"text",name:"shortDesc",value:c,onChange:this.handleChange})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Description: "),r.a.createElement("textarea",{className:"textarea",type:"text",rows:"2",style:{resize:"none"},name:"description",value:l,onChange:this.handleChange})),this.state.flash&&r.a.createElement("div",{className:"notification ".concat(this.state.flash.status)},this.state.flash.msg),r.a.createElement("div",{className:"field is-clearfix"},r.a.createElement("button",{className:"button is-primary is-danger is-outlined is-pulled-right",type:"submit",onClick:this.save},"Submit")))))):r.a.createElement(E.a,{to:"/"})}}]),t}(n.Component)),w=function(e){var a=e.cartItem,t=e.cartKey,n=a.product,s=a.amount;return r.a.createElement("div",{className:" column is-half"},r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image is-64x64"},r.a.createElement("img",{src:n.Img,alt:n.shortDesc}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("b",{style:{textTransform:"capitalize"}},n.name," ",r.a.createElement("span",{className:"tag is-primary"},"$",n.price)),r.a.createElement("div",null,n.shortDesc),r.a.createElement("small",null,"".concat(s," in cart"))),r.a.createElement("div",{className:"media-right",onClick:function(){return e.removeFromCart(t)}},r.a.createElement("span",{className:"delete is-large"})))))},j=y((function(e){var a=e.context.cart,t=Object.keys(a||{});return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"hero is-primary"},r.a.createElement("div",{className:"hero-body container"},r.a.createElement("h4",{className:"title"},"My Cart"))),r.a.createElement("br",null),r.a.createElement("div",{className:"container"},t.length?r.a.createElement("div",{className:"column columns is-multiline"},t.map((function(t){return r.a.createElement(w,{cartKey:t,key:t,cartItem:a[t],removeFromCart:e.context.removeFromCart})})),r.a.createElement("div",{className:"column is-12 is-clearfix"},r.a.createElement("br",null),r.a.createElement("div",{className:"is-pulled-right"},r.a.createElement("button",{onClick:e.context.clearCart,className:"button is-warning "},"Clear cart")," ",r.a.createElement("button",{className:"button is-success",onClick:e.context.checkout},"Checkout")))):r.a.createElement("div",{className:"column"},r.a.createElement("div",{className:"title has-text-grey-light"},"No item in cart!"))))})),I=y(function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var n;return Object(u.a)(this,t),(n=a.call(this,e)).handleChange=function(e){var a;return n.setState((a={},Object(N.a)(a,e.target.name,e.target.value),Object(N.a)(a,"error",""),a))},n.login=function(e){e.preventDefault();var a=n.state,t=a.username,r=a.password;if(!t||!r)return n.setState({error:"Fill all fields!"});n.props.context.login(t,r).then((function(e){e||n.setState({error:"Invalid Credentails"})}))},n.state={username:"",password:""},n}return Object(d.a)(t,[{key:"render",value:function(){return this.props.context.user?r.a.createElement(E.a,{to:"/products"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"hero is-primary "},r.a.createElement("div",{className:"hero-body container"},r.a.createElement("h4",{className:"title"},"Login"))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("form",{onSubmit:this.login},r.a.createElement("div",{className:"columns is-mobile is-centered"},r.a.createElement("div",{className:"column is-one-third"},r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Email: "),r.a.createElement("input",{className:"input",type:"email",name:"username",onChange:this.handleChange})),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"Password: "),r.a.createElement("input",{className:"input",type:"password",name:"password",onChange:this.handleChange})),this.state.error&&r.a.createElement("div",{className:"has-text-danger"},this.state.error),r.a.createElement("div",{className:"field is-clearfix"},r.a.createElement("button",{className:"button is-primary is-outlined is-pulled-right"},"Submit"))))))}}]),t}(n.Component)),D=function(e){var a=e.product;return r.a.createElement("div",{className:" column is-half"},r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image is-64x64"},r.a.createElement("img",{src:a.Img,alt:a.shortDesc}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("b",{style:{textTransform:"capitalize"}},a.name," ",r.a.createElement("span",{className:"tag is-primary"},"$",a.price)),r.a.createElement("div",null,a.shortDesc),a.stock>0?r.a.createElement("small",null,a.stock+" Available"):r.a.createElement("small",{className:"has-text-danger"},"Out Of Stock"),r.a.createElement("div",{className:"is-clearfix"},r.a.createElement("button",{className:"button is-small is-outlined is-primary   is-pulled-right",onClick:function(){return e.addToCart({id:a.name,product:a,amount:1})}},"Add to Cart"))))))},P=y((function(e){var a=e.context.products;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"hero is-primary"},r.a.createElement("div",{className:"hero-body container"},r.a.createElement("h4",{className:"title"},"NUESTROS Products"))),r.a.createElement("br",null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"column columns is-multiline"},a&&a.length?a.map((function(a,t){return r.a.createElement(D,{product:a,key:t,addToCart:e.context.addToCart})})):r.a.createElement("div",{className:"column"},r.a.createElement("span",{className:"title has-text-grey-light"},"No products found!")))))})),A=function(e){Object(h.a)(t,e);var a=Object(p.a)(t);function t(e){var n;return Object(u.a)(this,t),(n=a.call(this,e)).login=function(){var e=Object(o.a)(m.a.mark((function e(a,t){var r,s,c,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("http://localhost:3001/login",{email:a,password:t}).catch((function(e){return{status:401,message:"Unauthorized"}}));case 2:if(200!==(r=e.sent).status){e.next=11;break}return s=Object(g.a)(r.data.accessToken),c=s.email,l={email:c,token:r.data.accessToken,accessLevel:"admin@example.com"===c?0:1},n.setState({user:l}),localStorage.setItem("user",JSON.stringify(l)),e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),n.logout=function(e){e.preventDefault(),n.setState({user:null}),localStorage.removeItem("user")},n.addProduct=function(e,a){var t=n.state.products.slice();t.push(e),n.setState({products:t},(function(){return a&&a()}))},n.AddUser=function(e,a){var t=n.state.users.slice();t.push(e),n.setState({users:t},(function(){return a&&a()}))},n.addToCart=function(e){var a=n.state.cart;a[e.id]?a[e.id].amount+=e.amount:a[e.id]=e,a[e.id].amount>a[e.id].product.stock&&(a[e.id].amount=a[e.id].product.stock),localStorage.setItem("cart",JSON.stringify(a)),n.setState({cart:a})},n.removeFromCart=function(e){var a=n.state.cart;delete a[e],localStorage.setItem("cart",JSON.stringify(a)),n.setState({cart:a})},n.clearCart=function(){localStorage.removeItem("cart"),n.setState({cart:{}})},n.checkout=function(){if(n.state.user){var e=n.state.cart,a=n.state.products.map((function(a){return e[a.name]&&(a.stock=a.stock-e[a.name].amount,f.a.put("http://localhost:3001/products/".concat(a.id),Object(l.a)({},a))),a}));n.setState({products:a}),n.clearCart()}else n.routerRef.current.history.push("/login")},n.state={user:null,cart:{},products:[]},n.routerRef=r.a.createRef(),n}return Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(m.a.mark((function e(){var a,t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("user"),t=localStorage.getItem("cart"),e.next=4,f.a.get("http://localhost:3001/products");case 4:n=e.sent,a=a?JSON.parse(a):null,t=t?JSON.parse(t):{},this.setState({user:a,products:n.data,cart:t});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(C.Provider,{value:Object(l.a)(Object(l.a)({},this.state),{},{removeFromCart:this.removeFromCart,addToCart:this.addToCart,login:this.login,addProduct:this.addProduct,AddUser:this.AddUser,clearCart:this.clearCart,checkout:this.checkout})},r.a.createElement(v.a,{ref:this.routerRef},r.a.createElement("div",{className:"App"},r.a.createElement("nav",{className:"navbar container",role:"navigation","aria-label":"main navigation"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("b",{className:"navbar-item is-size-4 "},"ecommerce"),r.a.createElement("label",{role:"button",class:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:function(a){a.preventDefault(),e.setState({showMenu:!e.state.showMenu})}},r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}),r.a.createElement("span",{"aria-hidden":"true"}))),r.a.createElement("div",{className:"navbar-menu ".concat(this.state.showMenu?"is-active":"")},r.a.createElement(v.b,{to:"/products",className:"navbar-item"},"Products"),this.state.user&&this.state.user.accessLevel<1&&r.a.createElement(v.b,{to:"/add-product",className:"navbar-item"},"Add Product"),this.state.user&&this.state.user.accessLevel<1&&r.a.createElement(v.b,{to:"/add-usuario",className:"navbar-item"},"Add USUARIO"),r.a.createElement(v.b,{to:"/cart",className:"navbar-item"},"Cart",r.a.createElement("span",{className:"tag is-primary",style:{marginLeft:"5px"}},Object.keys(this.state.cart).length)),this.state.user?r.a.createElement(v.b,{to:"/",onClick:this.logout,className:"navbar-item"},"Logout"):r.a.createElement(v.b,{to:"/login",className:"navbar-item"},"Login"))),r.a.createElement(E.d,null,r.a.createElement(E.b,{exact:!0,path:"/",component:P}),r.a.createElement(E.b,{exact:!0,path:"/login",component:I}),r.a.createElement(E.b,{exact:!0,path:"/cart",component:j}),r.a.createElement(E.b,{exact:!0,path:"/add-product",component:O}),r.a.createElement(E.b,{exact:!0,path:"/add-usuario",component:k}),r.a.createElement(E.b,{exact:!0,path:"/products",component:P})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(64);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.4f1597df.chunk.js.map